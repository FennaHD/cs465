import sys
from diffie_hellman import DiffieHellman
import unittest


class ModExpTest(unittest.TestCase):
	dh = DiffieHellman()

	def test_positive(self):
		sys.setrecursionlimit(1500)
		g = 5
		a = 2573847276834072487639317875293829332223787295477108957642672394495133899578069632998793772404047482703026540295672130780370036931446769529424944100960
		p = 2800972037945227323036254567247126975343590460514771387955221860840553381995016860687656730719464687986068436800524247768776936091505949418487214508443
		gamodp = 2043851295897312554882401312637136709590691382896635014272214134842418825342344458284839219429772537386855169020440058119426725806366294126050773686248
		self.assertEqual(self.dh.mod_exp(g, a, p), gamodp)

	def test_negative(self):
		sys.setrecursionlimit(1500)
		g = 4  # this integer is different
		a = 2573847276834072487639317875293829332223787295477108957642672394495133899578069632998793772404047482703026540295672130780370036931446769529424944100960
		p = 2800972037945227323036254567247126975343590460514771387955221860840553381995016860687656730719464687986068436800524247768776936091505949418487214508443
		gamodp = 2043851295897312554882401312637136709590691382896635014272214134842418825342344458284839219429772537386855169020440058119426725806366294126050773686248
		self.assertNotEqual(self.dh.mod_exp(g, a, p), gamodp)